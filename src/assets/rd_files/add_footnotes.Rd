% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_footnotes.R
\name{add_footnotes}
\alias{add_footnotes}
\title{Inserts Footnotes in appropriate places in Word files}
\usage{
add_footnotes(
  docx_in,
  docx_out,
  figures_path,
  tables_path,
  footnotes = NULL,
  include_object_path = FALSE,
  footnotes_fail_on_missing_metadata = TRUE,
  debug = F
)
}
\arguments{
\item{docx_in}{Path to the input .docx file}

\item{docx_out}{Path to output .docx to save to}

\item{figures_path}{Path to images and associated metadata directory}

\item{tables_path}{Path to tables and associated metadata directory}

\item{footnotes}{Path to standard_footnotes.yaml}

\item{include_object_path}{Boolean for including object path path in footnotes}

\item{footnotes_fail_on_missing_metadata}{Boolean for allowing objects to lack metadata and thus have no footnotes}

\item{debug}{Debug}
}
\description{
Reads in a .docx file and returns a new version with footnotes placed at appropriate places in the document.
}
\examples{
\dontrun{

# ---------------------------------------------------------------------------
# Load all dependencies
# ---------------------------------------------------------------------------
docx_in <- file.path(here::here(), "report", "shell", "template.docx")
doc_dirs <- make_doc_dirs(docx_in = docx_in)
figures_path <- file.path(here::here(), "OUTPUTS", "figures")
tables_path <- file.path(here::here(), "OUTPUTS", "tables")
footnotes <- file.path(here::here(), "report", "standard_footnotes.yaml")

# ---------------------------------------------------------------------------
# Step 1.
# Table addition running add_tables will format and insert tables into the doc.
# ---------------------------------------------------------------------------
add_tables(
  docx_in = docx_in,
  docx_out = doc_dirs$doc_tables,
  tables_path = tables_path
)

# ---------------------------------------------------------------------------
# Step 2.
# Next we place in the plots using the add_plots function.
# ---------------------------------------------------------------------------
add_plots(
  docx_in = doc_dirs$doc_tables,
  docx_out = doc_dirs$doc_tabs_figs,
  figures_path = figures_path
)

# ---------------------------------------------------------------------------
# Step 3.
# Now we can add the footnotes to all the inserted figures and tables.
# ---------------------------------------------------------------------------
add_footnotes(
  docx_in = doc_dirs$doc_tabs_figs,
  docx_out = doc_dirs$doc_draft,
  figures_path = figures_path,
  tables_path = tables_path,
  footnotes = footnotes,
  include_object_path = TRUE
  footnotes_fail_on_missing_metadata
)
}
}
